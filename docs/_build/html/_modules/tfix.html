
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>tfix &#8212; Python_PIC_GUI 1.0 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for tfix</h1><div class="highlight"><pre>
<div class="viewcode-block" id="RunSimulation"><a class="viewcode-back" href="../source/tfix.html#tfix.RunSimulation">[docs]</a><span></span><span class="k">class</span> <span class="nc">RunSimulation</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">loadNamelist</span><span class="p">(</span><span class="n">in1</span><span class="p">,</span> <span class="s1">&#39;input1&#39;</span><span class="p">)</span>  <span class="c1"># Read into a fortran module</span>
        <span class="n">loadNamelist</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="s1">&#39;declares&#39;</span><span class="p">)</span>  <span class="c1"># read in to python</span>
        <span class="c1"># Line 58</span>
        <span class="n">diag</span><span class="o">.</span><span class="n">copyint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">idcode</span><span class="p">)</span>
        <span class="n">diag</span><span class="o">.</span><span class="n">copyint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">psolve</span><span class="p">)</span>
        <span class="n">diag</span><span class="o">.</span><span class="n">copyint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>
        <span class="c1"># line 63</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cdrun</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">in1</span><span class="o">.</span><span class="n">idrun</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dfname</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;output1.&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cdrun</span><span class="p">)),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="c1"># Line 70</span>
        <span class="c1"># np = total number of electrons in simulation.</span>
        <span class="n">C</span><span class="o">.</span><span class="n">np</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">in1</span><span class="o">.</span><span class="n">npx</span> <span class="o">+</span> <span class="n">in1</span><span class="o">.</span><span class="n">npxb</span>
        <span class="n">C</span><span class="o">.</span><span class="n">npx1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">in1</span><span class="o">.</span><span class="n">npx</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">C</span><span class="o">.</span><span class="n">nx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">in1</span><span class="o">.</span><span class="n">indx</span>
        <span class="n">C</span><span class="o">.</span><span class="n">nxh</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">nx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">C</span><span class="o">.</span><span class="n">nxe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">nx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">4</span>
        <span class="k">if</span> <span class="n">in1</span><span class="o">.</span><span class="n">inorder</span> <span class="o">==</span> <span class="n">gl</span><span class="o">.</span><span class="n">linear</span><span class="p">:</span>
            <span class="n">C</span><span class="o">.</span><span class="n">nxe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">nx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="n">in1</span><span class="o">.</span><span class="n">inorder</span> <span class="o">==</span> <span class="n">gl</span><span class="o">.</span><span class="n">cubic</span><span class="p">:</span>
            <span class="n">C</span><span class="o">.</span><span class="n">nxe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">nx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">6</span>
        <span class="c1"># dimension for index and sorting arrays</span>
        <span class="n">C</span><span class="o">.</span><span class="n">nx1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">nx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="c1"># nloop = number of time steps in simulation</span>
        <span class="n">C</span><span class="o">.</span><span class="n">nloop</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">in1</span><span class="o">.</span><span class="n">tend</span> <span class="o">/</span> <span class="n">in1</span><span class="o">.</span><span class="n">dt</span> <span class="o">+</span> <span class="o">.</span><span class="mi">0001</span>
        <span class="c1"># part(1,n) = position x of particle n</span>
        <span class="c1"># part(2,n) = velocity vx of particle n</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">part</span> <span class="o">=</span> <span class="n">NP</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">C</span><span class="o">.</span><span class="n">idimp</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">np</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">fType</span><span class="p">(</span><span class="s1">&#39;real&#39;</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qe</span> <span class="o">=</span> <span class="n">NP</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">nxe</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">fType</span><span class="p">(</span><span class="s1">&#39;real&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fxe</span> <span class="o">=</span> <span class="n">NP</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">nxe</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">fType</span><span class="p">(</span><span class="s1">&#39;real&#39;</span><span class="p">))</span>
        <span class="c1"># ffc = form factor array for poisson solver</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ffc</span> <span class="o">=</span> <span class="n">NP</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">nxh</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">fType</span><span class="p">(</span><span class="s1">&#39;complex&#39;</span><span class="p">))</span>
        <span class="c1"># mixup = array of bit reversed addresses for fft</span>
        <span class="c1"># sct = sine/cosine table for fft</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mixup</span> <span class="o">=</span> <span class="n">NP</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">nxh</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">fType</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sct</span> <span class="o">=</span> <span class="n">NP</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">nxh</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">fType</span><span class="p">(</span><span class="s1">&#39;complex&#39;</span><span class="p">))</span>
        <span class="c1"># open graphics device</span>
        <span class="n">C</span><span class="o">.</span><span class="n">irc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">diag</span><span class="o">.</span><span class="n">open_graphs</span><span class="p">(</span><span class="n">in1</span><span class="o">.</span><span class="n">nplot</span><span class="p">)</span>
        <span class="c1"># initialize timer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tt</span> <span class="o">=</span> <span class="n">diag</span><span class="o">.</span><span class="n">wtimer</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">ltime</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">C</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span>
        <span class="c1"># initialize constants</span>
        <span class="n">C</span><span class="o">.</span><span class="n">itime</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">itime0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">C</span><span class="o">.</span><span class="n">ntime</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">itime</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">C</span><span class="o">.</span><span class="n">itime0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">C</span><span class="o">.</span><span class="n">qbme</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">in1</span><span class="o">.</span><span class="n">qme</span>
        <span class="n">C</span><span class="o">.</span><span class="n">affp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">nx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">np</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="c1"># set initial time</span>
        <span class="n">diag</span><span class="o">.</span><span class="n">copyint</span><span class="p">(</span><span class="n">in1</span><span class="o">.</span><span class="n">dt</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">itime0</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">t0</span><span class="p">)</span>
        <span class="c1"># set default diagnostic file names</span>
        <span class="k">if</span> <span class="n">in1</span><span class="o">.</span><span class="n">ntp</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fpname</span> <span class="o">=</span> <span class="s1">&#39;potk1.&#39;</span>  <span class="c1"># //cdrun</span>
        <span class="c1"># energy time history</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">in1</span><span class="o">.</span><span class="n">ntw</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wt</span> <span class="o">=</span> <span class="n">NP</span><span class="o">.</span><span class="n">empty</span><span class="p">(((</span><span class="n">C</span><span class="o">.</span><span class="n">nloop</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">in1</span><span class="o">.</span><span class="n">ntw</span> <span class="o">-</span> <span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">itime0</span> <span class="o">/</span> <span class="n">in1</span><span class="o">.</span><span class="n">ntw</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">fType</span><span class="p">(</span><span class="s1">&#39;real&#39;</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
            <span class="n">C</span><span class="o">.</span><span class="n">itw</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="c1"># prepare fft tables</span>
        <span class="n">pyfft1mod</span><span class="o">.</span><span class="n">fft1d</span><span class="o">.</span><span class="n">ifft1rxinit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mixup</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sct</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">indx</span><span class="p">)</span>
        <span class="c1"># calculate form factors</span>
        <span class="n">fld</span><span class="o">.</span><span class="n">ipois1init</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ffc</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">ax</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">affp</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">nx</span><span class="p">)</span>
        <span class="c1"># initialize density profile and velocity distribution</span>
        <span class="c1"># background electrons</span>
        <span class="k">if</span> <span class="n">in1</span><span class="o">.</span><span class="n">npx</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">distr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">part</span><span class="p">,</span> <span class="n">rightType</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">in1</span><span class="o">.</span><span class="n">npx</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">vtx</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">vx0</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">npx</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">ipbc</span><span class="p">)</span>
        <span class="c1"># beam electrons</span>
        <span class="k">if</span> <span class="n">in1</span><span class="o">.</span><span class="n">npxb</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">distr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">part</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">npx1</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">npxb</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">vtdx</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">vdx</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">npxb</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">ipbc</span><span class="p">)</span>
        <span class="c1"># initialize charge density to background</span>
        <span class="n">C</span><span class="o">.</span><span class="n">qi0</span> <span class="o">=</span> <span class="o">-</span><span class="n">in1</span><span class="o">.</span><span class="n">qme</span> <span class="o">/</span> <span class="n">C</span><span class="o">.</span><span class="n">affp</span>
        <span class="c1"># ! calculate initial electron momentum</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">in1</span><span class="o">.</span><span class="n">ntm</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">psm</span><span class="o">.</span><span class="n">initmomt1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">part</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">np</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">pxe</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">pye</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">pze</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>
        <span class="c1"># sorting arrays</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">in1</span><span class="o">.</span><span class="n">sortime</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pt</span> <span class="o">=</span> <span class="n">NP</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">np</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">fType</span><span class="p">(</span><span class="s1">&#39;real&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ip</span> <span class="o">=</span> <span class="n">NP</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">np</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">fType</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">npic</span> <span class="o">=</span> <span class="n">NP</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">nx1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">fType</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tres</span> <span class="o">=</span> <span class="n">diag</span><span class="o">.</span><span class="n">get_funit</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">iudm</span><span class="p">)</span>
        <span class="n">diag</span><span class="o">.</span><span class="n">copyint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tres</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">iudm</span><span class="p">)</span>  <span class="c1"># Not doing it this way causes some weird python error</span>
        <span class="c1"># velocity diagnostic</span>
        <span class="k">if</span> <span class="n">in1</span><span class="o">.</span><span class="n">ntv</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fv</span> <span class="o">=</span> <span class="n">NP</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">nmv</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">fType</span><span class="p">(</span><span class="s1">&#39;real&#39;</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fvm</span> <span class="o">=</span> <span class="n">NP</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">fType</span><span class="p">(</span><span class="s1">&#39;real&#39;</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fv</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mf">8.0</span> <span class="o">*</span> <span class="n">in1</span><span class="o">.</span><span class="n">vtx</span>
        <span class="c1"># potential diagnostic</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">in1</span><span class="o">.</span><span class="n">ntp</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sfield</span> <span class="o">=</span> <span class="n">NP</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">nxe</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">fType</span><span class="p">(</span><span class="s1">&#39;real&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">in1</span><span class="o">.</span><span class="n">modesxp</span> <span class="o">&gt;</span> <span class="n">C</span><span class="o">.</span><span class="n">nxh</span><span class="p">):</span>
                <span class="n">diag</span><span class="o">.</span><span class="n">copyint</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">nxh</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">modesxp</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pott</span> <span class="o">=</span> <span class="n">NP</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">in1</span><span class="o">.</span><span class="n">modesxp</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">fType</span><span class="p">(</span><span class="s1">&#39;complex&#39;</span><span class="p">))</span>
            <span class="c1"># 162: Skipped a bunch of stuff record time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tt</span> <span class="o">=</span> <span class="n">diag</span><span class="o">.</span><span class="n">wtimer</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">ltime</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">C</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span>
        <span class="c1"># write (iuot,*) &#39;initialization wall clock time = &#39;, time, &#39;sec&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dfname</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;initialization wall clock time = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;sec</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">while</span> <span class="n">C</span><span class="o">.</span><span class="n">nloop</span> <span class="o">&gt;=</span> <span class="n">C</span><span class="o">.</span><span class="n">ntime</span><span class="p">:</span>
            <span class="c1"># ! initialize charge density to background</span>
            <span class="n">fld</span><span class="o">.</span><span class="n">isguard1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qe</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">qi0</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">inorder</span><span class="p">)</span>
            <span class="c1"># ! deposit electron charge</span>
            <span class="n">psm</span><span class="o">.</span><span class="n">igpost1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">part</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">qe</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">np</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">qme</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">tdpost</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">inorder</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">dopt</span><span class="p">)</span>
            <span class="c1"># ! add guard cells</span>
            <span class="n">fld</span><span class="o">.</span><span class="n">iaguard1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qe</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">inorder</span><span class="p">)</span>
            <span class="c1"># ! velocity diagnostic</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">in1</span><span class="o">.</span><span class="n">ntv</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">C</span><span class="o">.</span><span class="n">it</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">ntime</span> <span class="o">/</span> <span class="n">in1</span><span class="o">.</span><span class="n">ntv</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">ntime</span> <span class="o">==</span> <span class="n">in1</span><span class="o">.</span><span class="n">ntv</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">it</span><span class="p">):</span>
                    <span class="c1"># ! calculate particle distribution function and moments</span>
                    <span class="n">diag</span><span class="o">.</span><span class="n">ivdist1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">part</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fvm</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">np</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">nmv</span><span class="p">)</span>
                    <span class="c1"># ! display velocity distributions</span>
                    <span class="n">diag</span><span class="o">.</span><span class="n">idisplayfv1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fvm</span><span class="p">,</span> <span class="s1">&#39; ELECTRON&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">ntime</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">nmv</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">irc</span><span class="p">)</span>
                    <span class="c1"># plt.plot(fv)</span>
                    <span class="c1"># plt.show()</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">irc</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                        <span class="k">break</span>
                        <span class="c1"># ! phase space diagnostic</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">in1</span><span class="o">.</span><span class="n">nts</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">C</span><span class="o">.</span><span class="n">it</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">ntime</span> <span class="o">/</span> <span class="n">in1</span><span class="o">.</span><span class="n">nts</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">ntime</span> <span class="o">==</span> <span class="n">in1</span><span class="o">.</span><span class="n">nts</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">it</span><span class="p">):</span>
                    <span class="c1"># ! plot particles vx versus x</span>
                    <span class="n">diag</span><span class="o">.</span><span class="n">igrasp13</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">part</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">np</span><span class="p">,</span> <span class="s1">&#39; ELECTRON&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">ntime</span><span class="p">,</span> <span class="mi">999</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">npx</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">irc</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">irc</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                        <span class="k">break</span>
                        <span class="c1"># ! transform charge to fourier space</span>
            <span class="n">C</span><span class="o">.</span><span class="n">isign</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">C</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">fft</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qe</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">isign</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mixup</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sct</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">tfft</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">indx</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">inorder</span><span class="p">)</span>
            <span class="c1"># ! potential diagnostic</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">in1</span><span class="o">.</span><span class="n">ntp</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">C</span><span class="o">.</span><span class="n">it</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">ntime</span> <span class="o">/</span> <span class="n">in1</span><span class="o">.</span><span class="n">ntp</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">ntime</span> <span class="o">==</span> <span class="n">in1</span><span class="o">.</span><span class="n">ntp</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">it</span><span class="p">):</span>
                    <span class="c1"># ! calculate potential in fourier space</span>
                    <span class="n">C</span><span class="o">.</span><span class="n">isign</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">fld</span><span class="o">.</span><span class="n">ipois1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qe</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sfield</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">isign</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ffc</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">ws</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">inorder</span><span class="p">)</span>
                    <span class="c1"># ! store selected fourier modes</span>
                    <span class="n">gtmodes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sfield</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pott</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">modesxp</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">inorder</span><span class="p">)</span>
                    <span class="c1"># ! write diagnostic output</span>
                    <span class="c1"># writebf(pott,modesxp,iup,nprec,order=LINEAR)</span>
                    <span class="c1"># ! transform potential to real space</span>
                    <span class="n">fft</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sfield</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">isign</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mixup</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sct</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">tfft</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">indx</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">inorder</span><span class="p">)</span>
                    <span class="n">cguard</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sfield</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">inorder</span><span class="p">)</span>
                    <span class="c1"># ! display potential</span>
                    <span class="n">diag</span><span class="o">.</span><span class="n">idscaler1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sfield</span><span class="p">,</span> <span class="s1">&#39; POTENTIAL&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">ntime</span><span class="p">,</span> <span class="mi">999</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">irc</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">inorder</span><span class="p">)</span>
                    <span class="c1"># plt.plot(sfield)</span>
                    <span class="c1"># plt.show()</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">irc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                        <span class="k">break</span>
                        <span class="c1"># ! calculate force/charge in fourier space</span>
            <span class="n">C</span><span class="o">.</span><span class="n">isign</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">fld</span><span class="o">.</span><span class="n">ipois1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qe</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fxe</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">isign</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ffc</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">we</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">inorder</span><span class="p">)</span>
            <span class="c1"># ! transform force/charge to real space</span>
            <span class="n">C</span><span class="o">.</span><span class="n">isign</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">fft</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fxe</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">isign</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mixup</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sct</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">tfft</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">indx</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">inorder</span><span class="p">)</span>
            <span class="n">cguard</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fxe</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">inorder</span><span class="p">)</span>
            <span class="c1"># ! push particles</span>
            <span class="n">C</span><span class="o">.</span><span class="n">wke</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="c1"># modifies part, wke</span>
            <span class="n">psm</span><span class="o">.</span><span class="n">igpush1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">part</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fxe</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">np</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">qbme</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">dt</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">wke</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">tpush</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">ipbc</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">inorder</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">popt</span><span class="p">)</span>
            <span class="c1"># ! momentum diagnostic</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">in1</span><span class="o">.</span><span class="n">ntm</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>  <span class="c1"># ntm is zero.  Not fixing this code</span>
                <span class="n">C</span><span class="o">.</span><span class="n">it</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">ntime</span> <span class="o">/</span> <span class="n">in1</span><span class="o">.</span><span class="n">ntm</span>
                <span class="c1"># ! calculate and print electron momentum</span>
                <span class="n">C</span><span class="o">.</span><span class="n">it</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">ntime</span> <span class="o">-</span> <span class="n">in1</span><span class="o">.</span><span class="n">ntm</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">it</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">it</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="n">C</span><span class="o">.</span><span class="n">it</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">it</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">in1</span><span class="o">.</span><span class="n">ntm</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">it</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">premoment1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">part</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">ntime</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">np</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">ium</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">pxe</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">pye</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">pze</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">zero</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">zero</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">zero</span> \
                               <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wz</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">ndim</span><span class="p">,</span> <span class="n">nprint</span><span class="o">=</span><span class="n">it</span><span class="p">)</span>
            <span class="c1"># sort electrons</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">in1</span><span class="o">.</span><span class="n">sortime</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">ntime</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">%</span> <span class="n">in1</span><span class="o">.</span><span class="n">sortime</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">psm</span><span class="o">.</span><span class="n">isortp1x</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">part</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">np</span><span class="p">,</span> <span class="n">npic</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">tsort</span><span class="p">,</span> <span class="n">in1</span><span class="o">.</span><span class="n">inorder</span><span class="p">)</span>
            <span class="n">C</span><span class="o">.</span><span class="n">itime</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">itime</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">C</span><span class="o">.</span><span class="n">ntime</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">itime</span> <span class="o">+</span> <span class="n">C</span><span class="o">.</span><span class="n">itime0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tloop</span> <span class="o">=</span> <span class="n">diag</span><span class="o">.</span><span class="n">wtimer</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">ltime</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">C</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">time</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">tloop</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Joshua Kelly.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>